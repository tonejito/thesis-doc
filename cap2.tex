  \label{chap:cap2}
  \chapter {Definici\'{o}n del problema y soluci\'{o}n propuesta}

    \section {Problem\'{a}tica actual}

Los usuarios de la Divisi\'{o}n de Ingenier\'{i}as Civil y Geom\'{a}tica utilizan memorias \textsc{USB}, discos \'{o}pticos y carpetas compartidas en red para acceder a archivos de uso interno como documentos, presentaciones e im\'{a}genes que ocupan para realizar sus actividades.

Adicionalmente el personal de la Unidad de C\'{o}mputo almacena los archivos de instalaci\'{o}n de programas y controladores en dispositivos externos como memorias \textsc{USB}, discos duros externos \'{o} en discos \'{o}pticos y los utiliza al dar mantenimiento a los equipos de c\'{o}mputo de la divisi\'{o}n.

El problema al mantener los archivos en carpetas compartidas o utilizar un medio de almacenamiento externo es que los datos dejan de estar disponibles si el equipo que comparte la carpeta se encuentra apagado o si el medio de almacenamiento no est\'{a} conectado al equipo donde se procesa la informaci\'{o}n.

Por ejemplo, si un profesor necesita compartir algunos archivos con los alumnos parar utilizarlos en clase copia a una memoria \textsc{USB} los archivos y la pasa a cada uno de los estudiantes para que copien los archivos a su equipo lo cual, adem\'{a}s de que implica tiempo, es un proceso propenso a errores donde se puede da\~{n}ar la memoria flash que circula entre los equipos o se puede infectar con \textit{malware} \footnote{\textit{Malware}: software malicioso} en un equipo y al pasar de equipo a equipo propagar la infecci\'{o}n.

Otro caso muy com\'{u}n es el env\'{i}o de archivos modificados por correo electr\'{o}nico, generando as\'{i} una lista de versiones diferentes del mismo archivo que causan confusi\'{o}n porque se desconoce cual es la versi\'{o}n m\'{a}s actualizada.

    \section {Soluci\'{o}n propuesta}

Para solventar este problema se propone instalar un servidor de almacenamiento que provea espacio para que los usuarios de la \textsc{DICyG} puedan guardar su informaci\'{o}n y accederla desde los equipos conectados a la red interna a trav\'{e}s de una conexi\'{o}n cifrada.

La implementaci\'{o}n del servidor de almacenamiento ayudar\'{a} a liberar espacio en los equipos de c\'{o}mputo de la divisi\'{o}n que se utilizan para compartir archivos y proporcionar\'{a} un repositorio central que guarde la informaci\'{o}n y la haga accesible a los usuarios sin depender de un equipo externo.

% Usuarios de la Divisi\'{o}n de Ingenier\'{i}a Civil y Geom\'{a}tica (Depto de Geomatica) y Unidad de Computo
% 50 usuarios
% Almacenamiento centralizado para guardar imagenes o documentos y poderlos visualizar o editar en cualquier equipo conectado a la red de la division (archivos ligeros)
% Almacenamiento de archivos de intalacion para uso de la unidad de computo (archivos pesados)
% % Alcance
% Implementaci\'{o}n, hardening, interfaz de cambio de contrase\~{n}a, pruebas de seguridad y de compatibilidad
% % Justificacion
% proveer el servicio de almacenamiento centralizado a los usuarios de la dicyg
% reglas de acceso para las redes, 
% la transmision de datos esta cifrada, los datos no se cifran en el servidor
% disponibilidad de los datos en los horarios establecidos
% liberar espacio y evitar el uso de medios externos para transmitir la informacion
% poderlos visualizar o editar en cualquier equipo conectado a la red de la division

    \section {Tecnolog\'{i}as a utilizar}

Para la implementaci\'{o}n de este proyecto se utilizar\'{a}n las siguientes tecnolog\'{i}as:

\begin{itemize}
  \item Debian GNU/Linux como sistema operativo del appliance.
  \item Apache HTTPD para proveer el servicio de HTTPS.
  \item OpenLDAP para implementar el directorio de usuarios.
  \item OpenSSH para el acceso remoto por linea de comandos.
\end{itemize}

    \section {Arquitectura del prototipo}

El prototipo ser\'{a} implementado en un servidor proporcionado por la \textsc{DICyG} que almacenar\'{a} los archivos que los profesores utilizan en sus clases, as\'{i} como los programas de instalaci\'{o}n y software de controladores de dispositivo que la Unidad de C\'{o}mputo utiliza para dar mantenimiento a los equipos de la divisi\'{o}n.

      \subsection {Diagrama funcional}

%{
%\scriptsize
%\linespread{1}
%\begin{verbatim}
%                        +---------+       +-----+
%                     22 | OpenSSH |------>| pam |----------+
%                        +---------+       +-----+          |
%                                                           v
%                                                      +----------+
%                                                      | OpenLDAP |
%                                                      +----------+
%      ro-------                                            ^
%               \        +--------------+                   |
%      rw--------+---443 | Apache HTTPD |-------------------+
%               /        +--------------+
%    reset------
%\end{verbatim}
%}
\diagramblock
{Diagrama funcional de la soluci\'{o}n propuesta.}
{DiagramaFuncional}
{
 \psscalebox{1.0 1.0} % Change this value to rescale the drawing.
 {
  \begin{pspicture}(0,-3.0)(14.3,3.0)
  \psframe[linecolor=black, linewidth=0.04, dimen=outer](14.3,3.0)(5.9,-3.0)
  \psframe[linecolor=black, linewidth=0.04, dimen=outer](8.3,2.6)(6.3,1.4)
  \psframe[linecolor=black, linewidth=0.04, dimen=outer](8.3,1.0)(6.3,-1.0)
  \psframe[linecolor=black, linewidth=0.04, dimen=outer](10.7,2.6)(9.1,1.4)
  \psframe[linecolor=black, linewidth=0.04, dimen=outer](13.9,1.0)(11.5,-1.0)
  \rput[bl](6.51,1.8){OpenSSH}
  \rput[bl](9.5,1.8){pam}
  \rput[bl](11.79,-0.2){OpenLDAP}
  \rput[bl](6.67,0.2){Apache}
  \rput[bl](6.72,-0.6){HTTPD}
  \rput[bl](4.52,1.8){22/tcp}
  \rput[bl](4.3,0.2){443/tcp}
  \rput[bl](0.7,1.8){Cliente SSH}
  \rput[bl](0.0,-0.2){Navegador Web}
  \rput[bl](0.26,0.2){Cliente Nativo}
  \rput[bl](8.3,-2.2){WebDAV}
  \psframe[linecolor=black, linewidth=0.04, dimen=outer](10.3,-1.4)(7.9,-2.6)
  \rput[bl](12.3,-2.2){Archivos}
  \rput[bl](12.3,-2.6){Carpetas}
  \psline[linecolor=black, linewidth=0.04, arrowsize=0.05291666666666667cm 2.0,arrowlength=1.4,arrowinset=0.0]{->}(10.3,-2.2)(11.9,-2.2)(11.9,-2.2)
  \psline[linecolor=black, linewidth=0.04, arrowsize=0.05291666666666667cm 2.0,arrowlength=1.4,arrowinset=0.0]{->}(8.3,1.8)(9.1,1.8)(9.1,1.8)
  \psline[linecolor=black, linewidth=0.04, arrowsize=0.05291666666666667cm 2.0,arrowlength=1.4,arrowinset=0.0]{->}(10.7,1.8)(12.7,1.8)(12.7,1.0)
  \psline[linecolor=black, linewidth=0.04, arrowsize=0.05291666666666667cm 2.0,arrowlength=1.4,arrowinset=0.0]{->}(8.3,0.2)(11.5,0.2)
  \psline[linecolor=black, linewidth=0.04, arrowsize=0.05291666666666667cm 2.0,arrowlength=1.4,arrowinset=0.0]{->}(7.1,-1.0)(7.1,-2.2)(7.9,-2.2)
  \psline[linecolor=black, linewidth=0.04, arrowsize=0.05291666666666667cm 2.0,arrowlength=1.4,arrowinset=0.0]{->}(3.1,1.8)(3.9,1.8)
  \psline[linecolor=black, linewidth=0.04, arrowsize=0.05291666666666667cm 2.0,arrowlength=1.4,arrowinset=0.0]{->}(3.1,0.2)(3.9,0.2)
  \end{pspicture}
 }
}

      \subsection {Autenticaci\'{o}n centralizada}

El t\'{e}rmino \textit{autenticaci\'{o}n centralizada} se refiere a contar con un repositorio central de usuarios que permita que las aplicaciones puedan verificar las credenciales de acceso \textit{autenticando} as\'{i} al usuario.

        \subsubsection {Autenticaci\'{o}n por medio de directorio}

Para tener un esquema de autenticaci\'{o}n centralizada se tendr\'{a} un directorio de usuarios que implemente el protocolo LDAP mediante el software \textsc{OpenLDAP}.

        \subsubsection {Estructura del directorio}

La estructura propuesta comprende varios contenedores que sirven para separar los tipos de objeto que forman parte del directorio, cada contenedor est\'{a} representado por una \textit{unidad organizacional} cuyo atributo \'{u}nico es el nombre \textbf{ou}. Los contenedores principales en la ra\'{i}z del directorio son los siguientes:

\begin{itemize}
  \item Contenedor de usuarios
  \item Contenedor de grupos
  \item Contenedor de materias
  \item Contenedor de cuentas de servicio
\end{itemize}

\textbf{\\ Contenedor de usuarios \\}

Clasifica los usuarios del sistema por tipo, cada usuario tiene un identificador \'{u}nico asignado llamado \textbf{uid} se subdivide en tres ramas:

\begin{itemize}

  \item \textbf{Personal de la \textit{Unidad de C\'{o}mputo} de la divisi\'{o}n}

  Estas cuentas de usuario son objetos de tipo \textit{posixAccount} y representan cuentas est\'{a}ndar de \textsc{UNIX}.

  \item \textbf{Profesores}

  Se almacenan en el directorio como objetos de tipo \textit{posixAccount} que representan cuentas est\'{a}ndar de \textsc{UNIX}.

  \item \textbf{Alumnos}

  Su representaci\'{o}n en el directorio es un objeto de tipo \textit{simpleSecurityObject} que se utiliza para asignar un usuario y contrase\~{n}a \'{u}nicamente.

\end{itemize}

\textbf{\\ Contenedor de grupos \\}

Existen tres clases de grupos de usuarios contemplados en el sistema, esto ayuda a permitir o negar el acceso a los recursos del servidor, un usuario puede pertenecer a uno o m\'{a}s grupos que se listan a continuaci\'{o}n.

\begin{itemize}

  \item \textbf{Usuarios de la \textsl{Unidad de C\'{o}mputo} de la divisi\'{o}n}

  Existe un grupo \'{u}nico que contiene a todos los usuarios pertenecientes a la \textit{Unidad de C\'{o}mputo} y se almacena como un objeto de tipo \textit{posixGroup} que representa un grupo est\'{a}ndar de usuarios \textsc{UNIX}.

  \item \textbf{Profesores}

  Existe un grupo individual para cada usuario y se almacena como \textit{posixGroup}.

  \item \textbf{Alumnos}

  Existen varios grupos que contienen al profesor, la materia y el grupo en el que se imparte, permiten dar acceso a la carpeta donde se almacenan los archivos de un grupo en particular se almacena internamente como un objeto de tipo \textit{groupOfNames}.

\end{itemize}

\textbf{\\ Contenedor de materias \\}

Permite almacenar el cat\'{a}logo de las materias que se imparten en la divisi\'{o}n. Se requiere para la asignaci\'{o}n de grupos a los profesores y alumnos.

\textbf{\\ Contenedor de cuentas de servicio \\}

Contiene cuentas de usuario asociadas a servicios de sistema, se utiliza para almacenar las cuentas que realizan b\'{u}squedas en el directorio.

\textbf{\\ Diagrama \\}
% Works with `pdflatex', not compatible with `latex'
%\pdfannot{/Subtype/Text/Contents(TEXT)}

El siguiente diagrama muestra la estructura del \'{a}rbol del directorio \textsc{LDAP}.

{
\scriptsize
\linespread{1}
\begin{verbatim}
+ dc=dicyg,dc=ingenieria,dc=unam,dc=mx
|
|-+ cn=admin
|
|-+ ou=users
| |-+ ou=profesores
| | |-+ uid=profesor01
| | |-+ uid=profesor02
| | |   ...
| | \-+ uid=...
| |
| |-+ ou=grupos
| | |-+ uid=grupo01
| | |-+ uid=grupo02
| | |   ...
| | \-+ uid=...
| |
| \-+ ou=unidadcomputo
|   |-+ uid=tiaricci
|   |-+ uid=unidadcomputo
|   |   ...  
|   \-+ uid=...
|  
|-+ ou=groups
| |-+ ou=unix
| | |-+ `ou=profesores
| | | |-+ cn=grupo01
| | | |-+ cn=grupo02
| | | |   ...
| | | \-+ cn=...
| | |
| | \-+ ou=staff
| |   |-+ cn=grupo01
| |   |-+ cn=grupo02
| |   |   ...
| |   \-+ cn=...
| |  
| \-+ ou=webdav
|   |-+ uid=tiaricci
|   |-+ uid=unidadcomputo
|   |   ...  
|   \-+ uid=...
|
|-+ ou=materias
|   |-+ cn=materia01
|   |-+ cn=materia02
|   |   ...
|   \-+ cn=...
|
\-+ ou=services
    |-+ cn=linux
    |-+ cn=apache2
    |   ...
    \-+ cn=...
\end{verbatim}
}
\

      \subsection {Mecanismos de acceso a los archivos}

Se propone establecer el acceso a los archivos utilizando mecanismos como \textsc{HTTP} est\'{a}ndar y \textsc{WebDAV}.

        \subsubsection {Acceso por HTTP}

          \textbf{\\ Acceso por HTTP est\'{a}ndar \\}

Para acceder a los archivos mediante las llamadas est\'{a}ndar del protocolo HTTP s\'{o}lo se necesita que el usuario tenga un navegador web, que acceda a la \textsc{URL} iniciando sesi\'{o}n, donde podr\'{a} navegar en los directorios a los que tenga acceso y podr\'{a} descargar los archivos si tiene permisos de acceder al directorio.

          \textbf{\\ Acceso por WebDAV \\}

Para el caso del acceso via \textsc{WebDAV} es necesario un cliente, los sistemas operativos de escritorio como \textsc{GNU/Linux}, \textsc{Solaris}, \textsc{*BSD\footnote{Cualquier versi\'{o}n de BSD como \textsc{OpenBSD, FreeBSD y NetBSD}}}, \textsc{Mac OS X} y Windows tienen un cliente nativo en sus interfaces gr\'{a}ficas del navegador de archivos.

Aunque en los sistemas operativos es posible instalar clientes de \textsc{WebDAV} para acceder a los archivos, se propone tomar las interfaces nativas del sistema operativo para facilitar el acceso a los archivos.

Los sistemas operativos m\'{o}viles como \textsc{Android} y Apple \textsc{iOS} es posible instalar clientes para acceder a los archivos via \textsc{WebDAV} o si no se desea acceder por este medio se puede utilizar la interfaz web est\'{a}ndar.

%        \subsubsection {Acceso por SSH}
%
%El sistema proporcionar\'{a} acceso via \textit{Secure Shell} para el grupo de usuarios de la \textit{Unidad de C\'{o}mputo} de la Divisi\'{o}n para que hagan uso del sistema de almacenamiento en los servidores y realicen respaldos automatizados si as\'{i} lo requieren.
%
%El acceso por \textsc{SSH} permite que los usuarios puedan copiar archivos a trav\'{e}s de los siguientes mecanismos descritos en el Cap\'{i}tulo 1\footnote{Ver p\'{a}gina \pageref{Protocolo-SSH} secci\'{o}n \ref{Protocolo-SSH}}:
%
%\begin{itemize}
%  \item{\textsc{SCP} - Secure Copy}.
%  \item{\textsc{SFTP} - Secure File Transfer Protocol}.
%  \item{\textsc{SSHFS} - Secure Shell Filesystem}.
%\end{itemize}

      \subsection {Interfaces de usuario}

Adem\'{a}s del acceso por \textsc{WebDAV} y por medio de un navegador web el appliance tendr\'{a} una interfaz de administraci\'{o}n para ver y modificar los atributos de los usuarios y una interfaz para que los usuarios puedan cambiar su contrase\~{n}a sin necesidad de acudir con el administrador.

        \subsubsection {Interfaz de administraci\'{o}n}

La interfaz de administraci\'{o}n que se propone permite ver, agregar, modificar y borrar registros del directorio. Se utilizar\'{a} la interfaz web \textit{LDAP Account Manager} y adem\'{a}s se puede instalar la herramienta \textit{Apache Directory Studio} en la workstation del administrador para realizar  estas tareas.

        \subsubsection {Interfaz de cambio de contrase\~{n}a}

Esta interfaz permite tanto al personal de la \textit{Unidad de C\'{o}mputo} como a los profesores cambiar la contrase\~{n}a de acceso que tienen asignada y al realizar esta acci\'{o}n env\'{i}a un correo para notificar que se llev\'{o} acabo.

    \subsection {Especificaci\'{o}n del appliance}

En la siguiente secci\'{o}n se muestran las configuraciones del hardware y software que tendr\'{a} el appliance, as\'{i} como los l\'{i}mites que soportar\'{a}.

      \section {Hardware}

% Poner en esta seccion las caracteristicas del equipo de pruebas y de produccion donde se pondra el appliance

\begin{table}[H]
\caption{Recursos de hardware utilizados para el appliance}{}
\label{tab:recursos-hardware}
\noindent\makebox[\textwidth]{%
\begin{tabular}[c]{c|c|c}
%\hline
\textbf{Elemento} & \textbf{M\'{i}nimo} & \textbf{Recomendado} \\
\hline \hline
\textit{Servidor} & \textbf{Pruebas} & \textbf{Producci\'{o}n} \\
\hline
\textit{CPU} & []x[] GHz & []x[] GHz \\
\textit{RAM} & [] GHz & [] GHz \\
\textit{Discos Duros} & []x[] GB & []x[] GB \\
\textit{Arreglo RAID} & RAID[]: [] & RAID[]: [] \\
%\hline
\end{tabular}
} % ending of \makebox
\end{table}

      \section {Software}

% Poner en esta seccion las caracteristicas del equipo de pruebas y de produccion donde se pondra el appliance

\begin{table}[H]
\caption{Versiones de software utilizados para el appliance}{}
\label{tab:versiones-software}
\noindent\makebox[\textwidth]{%
\begin{tabular}[c]{c|c|c}
%\hline
\textbf{Servidor} & \textbf{Pruebas} & \textbf{Producci\'{o}n} \\
\hline \hline
\textit{Sistema Operativo} & \multicolumn{2}{c}{Debian GNU/Linux 7 \textit{Wheezy}} \\
\textit{OpenSSH} & [] & [] \\
\textit{Apache httpd} & [] & [] \\
\textit{OpenLDAP} & [] & [] \\
\textit{PHP} & [] & [] \\
\textit{LDAP Account Manager} & [] & [] \\
\textit{LDAP Toolbox: Self Service Password} & [] & [] \\
%\hline
\end{tabular}
} % ending of \makebox
\end{table}

      \section {L\'{i}mites}

El appliance est\'{a} configurado para alojar los archivos del staff de la \textit{unidad de c\'{o}mputo} y los archivos que cada profesor designe para la impartici\'{o}n de cada curso.

\begin{table}[H]
\caption{Limites establecidos en el appliance}{}
\label{tab:limites-appliance}
\noindent\makebox[\textwidth]{%
\begin{tabular}[c]{c|c|c}
%\hline
\textbf{Servidor} & \textbf{Pruebas} & \textbf{Producci\'{o}n} \\
\hline \hline
% Se ve feo, mejorar el estilo visual
\multirow{2}{*}{Cuotas} & Staff: []GB & Staff: []GB \\
                        & Profesor: []GB & Profesor: []GB \\
\textit{Temperatura} & [] & [] \\
\textit{Voltaje} & []AC & []AC \\
%\hline
\end{tabular}
} % ending of \makebox
\end{table}

