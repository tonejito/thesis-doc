{
  \linespread{1}
  \cleardoublepage  
  \chapter{Implementaci\'{o}n de la soluci\'{o}n}
  \label{chap:cap3}
}

    \section {Configuraci\'{o}n del sistema operativo}

El sistema operativo que ser\'{a} utilizado para la implementaci\'{o}n es \textsc{Debian GNU/Linux} 7 \textit{\guillemotleft wheezy\guillemotright} se instalar\'{a} de manera nativa en el servidor y se le aplicar\'{a}n configuraciones personalizadas para ejecutar el \textit{software} que ser\'{a} implementado, ajustar el rendimiento y reforzar la seguridad de los servicios que ofrezca.

      \subsection {Arreglo de discos \textsc{RAID}}

Los discos duros del servidor ser\'{a}n configurados en un arreglo \textsc{RAID} debido a las ventajas que ofrece\footnote{Ver p\'{a}gina \pageref{Arreglos-RAID} secci\'{o}n \ref{Arreglos-RAID}}. La configuraci\'{o}n en el servidor de pruebas se realizar\'{a} con un arreglo \textsc{RAID} 1 por \textit{software} que se configur\'{o} de la siguiente manera: \cite{_softwareraid_????}

\begin{itemize}
  \item Instalar el programa para habilitar la compatibilidad con arreglos \textsc{RAID} por \textit{software}:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # apt-get install mdadm
\end{verbatim}
}

  \item Crear las particiones de tipo \textit{Linux RAID Autodetect} en cada disco del arreglo
    \begin{itemize}
      \item Crear una partici\'{o}n primaria que ocupe todo el espacio del disco:

{
\scriptsize
\linespread{1}
\begin{verbatim}

    # /sbin/fdisk /dev/sdb

    Device contains neither a valid DOS partition table, nor Sun, SGI or OSF disklabel
    Building a new DOS disklabel with disk identifier 0x00bab10c.
    Changes will remain in memory only, until you decide to write them.
    After that, of course, the previous content won't be recoverable.

    Warning: invalid flag 0x0000 of partition table 4 will be corrected by w(rite)

    Command (m for help): n
    Partition type:
       p   primary (0 primary, 0 extended, 4 free)
       e   extended
    Select (default p): p
    Partition number (1-4, default 1): 1
    First sector (2048-16777215, default 2048):
    Using default value 2048
    Last sector, +sectors or +size{K,M,G} (2048-16777215, default 16777215):
    Using default value 16777215
\end{verbatim}
}

      \item Cambiar el tipo de la partici\'{o}n a \texttt{0xfd} - \textit{Linux RAID Autodetect} y escribir la tabla de particiones al disco:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    Command (m for help): t
    Selected partition 1
    Hex code (type L to list codes): fd
    Changed system type of partition 1 to fd (Linux RAID Autodetect)

    Command (m for help): w
    The partition table has been altered!

    Calling ioctl() to re-read partition table.
    Syncing disks.
\end{verbatim}
}

    \end{itemize}
  \item Crear arreglo:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # mdadm --zero-superblock /dev/sdb1 /dev/sdc1
    # mdadm --create /dev/md0 --level=1 --raid-devices=2 /dev/sdb1 /dev/sdc1
\end{verbatim}
}

  \item Dar formato al disco que representa el arreglo:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # mkfs.ext4 /dev/md0
\end{verbatim}
}

  \item Asignar tipo y punto de montaje en el archivo \texttt{/etc/fstab}:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    /dev/md0 /opt/xNAS/files ext4 noatime,rw 0 0
\end{verbatim}
}

  \item Guardar configuraci\'{o}n en el archivo \texttt{/etc/mdadm/mdadm.conf}:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    ARRAY /dev/md0 devices=/dev/sdb1,/dev/sdc1 level=1 num-devices=2 auto=yes
    DEVICE /dev/sdb1 /dev/sdc1
\end{verbatim}
}

\end{itemize}

      \subsection {Punto de montaje de s\'{o}lo lectura}

Para evitar el acceso de escritura a los archivos pertenecientes a los profesores, se realiz\'{o} un montaje de tipo \textit{bind} con permisos de s\'{o}lo lectura. Debido a que se realizan dos operaciones de montaje, es necesario agregar las siguientes l\'{i}neas al \textit{script} \texttt{/etc/rc.local}. \cite{_mount_????} \cite{_read-only_????} \cite{_karel_????}

{
\scriptsize
\linespread{1}
\begin{verbatim}
	PREFIX=/opt/xNAS/files
	mount --bind $PREFIX/profesor $PREFIX/p
	mount -o remount,ro,bind $PREFIX/profesor $PREFIX/p
\end{verbatim}
}

    \section {Configuraci\'{o}n de los servicios}

      \subsection {OpenLDAP}

          \subsubsection {Instalaci\'{o}n de \textsc{OpenLDAP}}

Se instala \textsc{OpenLDAP} utilizando el comando \texttt{aptitude}, es necesario contestar \textbf{NO} en el cuadro de di\'{a}logo para seguir el asistente de instalaci\'{o}n:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # aptitude install slapd
\end{verbatim}
}


{
\scriptsize
\linespread{1}
\begin{verbatim}
+---------------------------+ Configuring slapd +----------------------------+
| If you enable this option, no initial configuration or database will be    |
| created for you.                                                           |
|                                                                            |
| Omit OpenLDAP server configuration?                                        |
|                    <Yes>                       <No>                        |
+----------------------------------------------------------------------------+
\end{verbatim}
}

Se pide el nombre DNS del dominio que servir\'{a} para conformar la ra\'{i}z del \'{a}rbol de \textsc{LDAP}.

{
\scriptsize
\linespread{1}
\begin{verbatim}
+---------------------------+ Configuring slapd +----------------------------+
| The DNS domain name is used to construct the base DN of the LDAP           |
| directory. For example, 'foo.example.org' will create the directory with   |
| 'dc=foo, dc=example, dc=org' as base DN.                                   |
|                                                                            |
| DNS domain name:                                                           |
| xnas.tonejito.org_________________________________________________________ |
|                                   <Ok>                                     |
+----------------------------------------------------------------------------+
\end{verbatim}
}

Adicionalmente el instalador pregunta por el nombre de la organizaci\'{o}n. Aunque este dato no es necesario, se recomienda introducirlo:

{
\scriptsize
\linespread{1}
\begin{verbatim}
+---------------------------+ Configuring slapd +----------------------------+
| Please enter the name of the organization to use in the base DN of your    |
| LDAP directory.                                                            |
|                                                                            |
| Organization name:                                                         |
| xNAS_____________________________________________________________________  |
|                                  <Ok>                                      |
+----------------------------------------------------------------------------+
\end{verbatim}
}

A continuaci\'{o}n se pide que se introduzca la contrase\~{n}a que ser\'{a} utilizada por el administrador del directorio:

{
\scriptsize
\linespread{1}
\begin{verbatim}
+-------------------------+ Configuring slapd +------------------------------+
| Please enter the password for the admin entry in your LDAP directory.      |
|                                                                            |
| Administrator password:                                                    |
| **********____________________________________________________________     |
|                                 <Ok>                                       |
+----------------------------------------------------------------------------+
\end{verbatim}
}

Se recomienda deshabilitar el soporte del protocolo \textsc{LDAPv2} puesto que es obsoleto, responder \textbf{NO} en el cuadro de di\'{a}logo.

{
\scriptsize
\linespread{1}
\begin{verbatim}
+----------------------------+ Configuring slapd +---------------------------+
|                                                                            |
| The obsolete LDAPv2 protocol is disabled by default in slapd. Programs and |
| users should upgrade to LDAPv3.  If you have old programs which can't use  |
| LDAPv3, you should select this option and 'allow bind_v2' will be added to |
| your slapd.conf file.                                                      |
|                                                                            |
| Allow LDAPv2 protocol?                                                     |
|                     <Yes>                        <No>                      |
+----------------------------------------------------------------------------+
\end{verbatim}
}

          \subsubsection {Configuraci\'{o}n de \textsc{OpenLDAP}}

Se configur\'{o} el sistema operativo para permitir que los usuarios de \textsc{LDAP} de tipo \textit{posixAccount} puedan iniciar sesi\'{o}n en el equipo.

{
\scriptsize
\linespread{1}
\begin{verbatim}
  # aptitude install libpam-ldapd
\end{verbatim}
}

Adicionalmente se instalaron los demonios \textsc{NSCD} y \textsc{NSLCD} que se utilizan para guardar en \textit{cach\'{e}} los resultados de las consultas al directorio y para representar los objetos \textit{posixAccount} de \textsc{LDAP} como cuentas est\'{a}ndar de \textsc{UNIX}.

{
\scriptsize
\linespread{1}
\begin{verbatim}
+------------------------+ Configuring libnss-ldapd +-------------------------+
| For this package to work, you need to modify your /etc/nsswitch.conf to     |
| use the ldap datasource.                                                    |
|                                                                             |
| You can select the services that should have LDAP lookups enabled. The new  |
| LDAP lookups will be added as the last datasource. Be sure to review these  |
| changes.                                                                    |
|                                                                             |
| Name services to configure:                                                 |
|    [*] group                                                                |
|    [*] passwd                                                               |
|    [*] shadow                                                               |
|                                   <Ok>                                      |
+-----------------------------------------------------------------------------+
\end{verbatim}
}

Para la configuraci\'{o}n de \textsc{PAM}, se indica que se utilizar\'{a}n como fuentes de autenticaci\'{o}n la base de datos est\'{a}ndar de UNIX y adicionalmente el directorio LDAP.

{
\scriptsize
\linespread{1}
\begin{verbatim}
+----------------------------+ PAM configuration +----------------------------+
| Pluggable Authentication Modules (PAM) determine how authentication,        |
| authorization, and password changing are handled on the system, as well as  |
| allowing configuration of additional actions to take when starting user     |
| sessions.                                                                   |
|                                                                             |
| Some PAM module packages provide profiles that can be used to               |
| automatically adjust the behavior of all PAM-using applications on the      |
| system.  Please indicate which of these behaviors you wish to enable.       |
|                                                                             |
| PAM profiles to enable:                                                     |
|    [*] Unix authentication                                                  |
|    [*] LDAP Authentication                                                  |
|                    <Ok>                        <Cancel>                     |
+-----------------------------------------------------------------------------+
\end{verbatim}
}

          \subsubsection {Inicializaci\'{o}n del directorio \textsc{LDAP}}

Una vez instalado el servicio de directorio, es necesario inicializar la estructura b\'{a}sica que comprende los contenedores de usuarios, materias y grupos utilizando el archivo \texttt{xNAS-base.ldif} y el comando \texttt{ldapadd}. En caso de requerir cambiar la contrase\~{n}a del administrador del directorio, seguir las indicaciones mostradas en las siguientes referencias \cite{_change_????} \cite{_openldap_????}

{
\scriptsize
\linespread{1}
\begin{verbatim}
# aptitude install ldap-utils
 \end{verbatim}
}

Se verifica que no existan objetos adicionales en el directorio. La salida del comando \texttt{ldapsearch} debe ser similar a la que se muestra a continuaci\'{o}n:

{
\scriptsize
\linespread{1}
\begin{verbatim}
# ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b 'dc=xnas,dc=local'

SASL/EXTERNAL authentication started
SASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth
SASL SSF: 0

dn: dc=xnas,dc=local
objectClass: top
objectClass: dcObject
objectClass: organization
o: xNAS
dc: xnas

dn: cn=admin,dc=xnas,dc=local
objectClass: simpleSecurityObject
objectClass: organizationalRole
cn: admin
description: LDAP administrator
 \end{verbatim}
}

Se procede con la inicializaci\'{o}n de la estructura b\'{a}sica del directorio.

{
\scriptsize
\linespread{1}
\begin{verbatim}
# ldapadd -x -W -D "cn=admin,dc=xnas,dc=local" -H 'ldapi:///' -f ./xNAS-base.ldif

Enter LDAP Password: 

adding new entry "ou=services,dc=xnas,dc=local"
adding new entry "ou=materias,dc=xnas,dc=local"
adding new entry "ou=users,dc=xnas,dc=local"
adding new entry "ou=staff,ou=users,dc=xnas,dc=local"
adding new entry "ou=profesores,ou=users,dc=xnas,dc=local"
adding new entry "ou=grupos,ou=users,dc=xnas,dc=local"
adding new entry "ou=alumnos,ou=users,dc=xnas,dc=local"
adding new entry "ou=groups,dc=xnas,dc=local"
adding new entry "ou=unix,ou=groups,dc=xnas,dc=local"
adding new entry "ou=webdav,ou=groups,dc=xnas,dc=local"
\end{verbatim}
}

\newpage
          \subsubsection {Carga de datos en el directorio \textsc{LDAP}}

Para realizar la carga de la base de datos de usuarios y grupos se desarroll\'{o} en el lenguaje de programaci\'{o}n \textsl{Ruby} una biblioteca y un script de carga que lee los datos desde un archivo origen en formato \texttt{CSV}, establece las relaciones entre los objetos y realiza el ingreso de los datos al directorio.

La biblioteca que realiza la carga de objetos funciona de acuerdo al siguiente algoritmo:

\begin{itemize}
  \item Realiza una conexi\'{o}n al directorio LDAP, a esta operaci\'{o}n se le denomina \textit{bind}.
  \item Convierte el archivo de entrada a la codificaci\'{o}n \textsc{UTF-8}.
  \item Lee cada rengl\'{o}n del archivo de entrada y verifica el contenido de cada campo contra una \textit{expresi\'{o}n regular} para identificar problemas.
  \item Si el rengl\'{o}n cumple con el formato, se contin\'{u}a con el pr\'{o}ximo paso, de lo contrario se guarda en una lista que debe ser revisada manualmente y salta al siguiente.
  \item Asigna los atributos de cada objeto LDAP de acuerdo al valor de cada campo.
  \item Establece las relaciones necesarias con otros objetos y realiza una transacci\'{o}n para insertar los datos en el directorio.
  \item Verifica que la inserci\'{o}n se haya realizado correctamente, en caso de existir alg\'{u}n error, se realiza un \textit{rollback} de las operaciones.
\end{itemize}

\diagramblock
{Diagrama de bloques de los scripts de carga}
{DiagramaScript}
{
 \psscalebox{1.0 1.0} % Change this value to rescale the drawing.
 {
  \input{figures/load-script-diagram}
 }
}

Cada archivo de entrada \texttt{CSV} tiene varias columnas que contienen informaci\'{o}n acerca del tipo de objeto que representa, a continuaci\'{o}n se muestran las columnas que se requieren en los archivos de entrada:

{
 \begin{table}[H]
 \caption{Formato de los archivos \textsl{CSV} para la carga de datos}{}
 \label{tab:csv-format}
 \noindent\makebox[\textwidth]
 {%
  \begin{tabular}[c]{c|c c c c c}
  %\hline
  \textbf{Archivo} & \multicolumn{5}{c}{\textbf{Columnas}} \\
  \hline \hline
  \textit{staff.csv} & usuario & nombre & correo & curp & \\
  \textit{materias.csv} & id & grupo & materia & rfc & profesor \\
  \textit{profesores.csv} & rfc & nombre & correo & & \\
  \textit{alumnos.csv} & cuenta & nombre & correo & asignatura & grupo \\
  %\hline
  \end{tabular}
 } % ending of \makebox
 \end{table}
}

Para la correcta ejecuci\'{o}n de los scripts es necesario instalar los paquetes \texttt{ruby}, \texttt{rubygems} y la gema de ruby que realiza la conexi\'{o}n con el directorio \textsc{LDAP}.

{
\scriptsize
\linespread{1}
\begin{verbatim}
  # aptitude install ruby rubygems ruby-json
  # gem install net-ldap
\end{verbatim}
}

Utilizando el script \texttt{./load.rb} se cargan los datos y se crean los objetos en el directorio:

{
\scriptsize
\linespread{1}
\begin{verbatim}
# ./load.rb

xNAS - ./load.rb

Enter username, press <ENTER> for default:
    username    [cn=admin]

Enter password (will not echo):
    password
\end{verbatim}
}

{
 \begin{table}[H]
 \caption{Script de carga de objetos en el directorio}{}
 \label{tab:load-rb}
 \noindent\makebox[\textwidth]
 {%
  \begin{tabular}[c]{c|c c}
  %\hline
  \textbf{Tipo} & \multicolumn{2}{c}{\textbf{Objetos creados en el directorio}} \\
  \hline \hline
  \textit{staff} & \textit{posixGroup} & \textit{posixAccount} \\
  \textit{profesores} & \textit{posixGroup} & \textit{posixAccount} \\
  \textit{materias} & \textit{organizationalRole} & \textit{groupOfNames} \\
  \textit{alumnos} & \multicolumn{2}{c}{\textit{simpleSecurityObject}} \\
  %\hline
  \end{tabular}
 } % ending of \makebox
 \end{table}
}

          \subsubsection {Borrado de datos en el directorio \textsc{LDAP}}

Se desarroll\'{o} un script que ayuda a limpiar el directorio cuando se pretenda cargar una nueva base de datos en el mismo.

{
\scriptsize
\linespread{1}
\begin{verbatim}
  # make clean
  # ./clean.rb

xNAS - ./clean.rb

Enter username, press <ENTER> for default:
    username	[cn=admin]

Enter password (will not echo):
    password

\end{verbatim}
}

      \subsection {Apache \textsc{httpd}}

En esta secci\'{o}n se describe el procedimiento que se realiz\'{o} para configurar el servicio de \textsc{HTTP} con \textsc{WebDAV} sobre \textsc{SSL}.

        \subsubsection {Esquema de configuraci\'{o}n}

La configuraci\'{o}n de Apache \textit{httpd} comprende tres \texttt{VirtualHost} que sirven como puntos de entrada para el acceso de s\'{o}lo lectura o lectura y escritura a los archivos almacenados en el servidor.

{
 \begin{table}[H]
 \caption{VirtualHost configurados en Apache HTTPD}{}
 \label{tab:virtualhost}
 \noindent\makebox[\textwidth]
 {%
  \begin{tabular}[c]{c|c}
  %\hline
  \textbf{VirtualHost} & \textbf{Funci\'{o}n} \\
  \hline \hline
  \texttt{xnas.tonejito.org} & Acceso a los archivos por medio de \textsc{WebDAV} \\
  \texttt{reset.xnas.tonejito.org} & Interfaz de cambio de contrase\~{n}a \\
  \texttt{admin.xnas.tonejito.org} & Interfaz administrativa del directorio \textsc{LDAP} \\
  %\hline
  \end{tabular}
 } % ending of \makebox
 \end{table}
}

Si el usuario accede al \textit{appliance} utilizando el nombre de dominio principal o la direcci\'{o}n IP, se presenta la interfaz de acceso a los archivos. Para acceder a la interfaz de administraci\'{o}n del directorio o para cambiar la contrase\~{n}a, se debe acceder utilizando el nombre de dominio designado en la tabla anterior.

\diagramblock
{Diagrama Apache HTTPD VirtualHost}
{DiagramaVirtualHost}
{
 \psscalebox{1.0 1.0} % Change this value to rescale the drawing.
 {
  \input{figures/apache-vhost}
 }
}

\newpage
El conjunto de archivos y configuraciones que forman parte del \textit{appliance} se organizan en diferentes carpetas como se muestra en la siguiente ilustraci\'{o}n:

\diagramblock
{Diagrama de configuraci\'{o}n de Apache HTTPD}
{DiagramaConf}
{
 \psscalebox{1.0 1.0} % Change this value to rescale the drawing.
 {
  \input{figures/apache-config}
 }
}

Se ingresaron en el sistema de archivos varias ligas simb\'{o}licas que apuntan a las configuraci\'{o}nes de Apache \textsc{HTTPD} que residane en el directorio \texttt{/opt/xNAS}.

{
 \linespread{1}
 \begin{table}[H]
 \caption{Archivos de configuraci\'{o}n de Apache \textsc{HTTPD}}{}
 \label{tab:system-config}
 \noindent\makebox[\textwidth]
 {%
  \begin{tabular}[c]{l|l}
  %\hline
  \multicolumn{1}{c}{\textbf{Liga simb\'{o}lica}} & \multicolumn{1}{c}{\textbf{Destino}} \\
  \hline \hline
  \scriptsize \texttt{/etc/apache2/extra}                            & \scriptsize \texttt{/opt/xNAS/apache2/extra} \\
  \scriptsize \texttt{/etc/apache2/sites-available/xnas.local}       & \scriptsize \texttt{/opt/xNAS/apache2/sites-available/default} \\
  \scriptsize \texttt{/etc/apache2/sites-available/reset.xnas.local} & \scriptsize \texttt{/opt/xNAS/apache2/sites-available/reset.xnas.local} \\
  \scriptsize \texttt{/etc/apache2/sites-available/admin.xnas.local} & \scriptsize \texttt{/opt/xNAS/apache2/sites-available/admin.xnas.local} \\
  \scriptsize \texttt{/etc/ssl/certs/ca.thesis.tonejito.info.crt}    & \scriptsize \texttt{/opt/xNAS/ssl/certs/ca.thesis.tonejito.info.crt} \\
  \scriptsize \texttt{/etc/ssl/certs/xnas.local.crt}                 & \scriptsize \texttt{/opt/xNAS/ssl/certs/xnas.local.crt} \\
%  \scriptsize \texttt{/etc/ssl/certs/reset.xnas.local.crt}           & \scriptsize \texttt{/opt/xNAS/ssl/certs/reset.xnas.local.crt} \\
  \scriptsize \texttt{/etc/ssl/certs/admin.xnas.local.crt}           & \scriptsize \texttt{/opt/xNAS/ssl/certs/admin.xnas.local.crt} \\
  \scriptsize \texttt{/etc/ssl/certs/xnas.local.key}                 & \scriptsize \texttt{/opt/xNAS/ssl/certs/xnas.local.key} \\
%  \scriptsize \texttt{/etc/ssl/certs/reset.xnas.local.key}           & \scriptsize \texttt{/opt/xNAS/ssl/certs/reset.xnas.local.key} \\
  \scriptsize \texttt{/etc/ssl/certs/admin.xnas.local.key}           & \scriptsize \texttt{/opt/xNAS/ssl/certs/admin.xnas.local.key} \\
  %\hline
  \end{tabular}
 } % ending of \makebox
 \end{table}
}

        \subsubsection {Configuraci\'{o}n del servicio}

Se instala el certificado \textsc{SSL} en \texttt{/etc/ssl/certs} y la llave privada en \texttt{/etc/ssl/private} mediante los siguientes comandos:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # cd /etc/ssl/private
    # ln -vsf /opt/xNAS/ssl/xnas.local.key
    # cd /etc/ssl/certs
    # ln -vsf /opt/xNAS/ssl/ca.thesis.tonejito.info.crt
    # ln -vsf /opt/xNAS/ssl/xnas.local.crt
    # c_rehash
\end{verbatim}
}

Se copia el archivo \texttt{ports.conf} al directorio principal de Apache \textit{httpd} con el objeto de configurar de manera adecuada la directiva \texttt{NameVirtualHost} para los sitios de \textsc{HTTPS}.

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # cd /opt/xNAS/apache2
    # cp ports.conf /etc/apache2
    # /etc/init.d/apache2 restart
    # apache2ctl -S
\end{verbatim}
}

Se habilita el acceso a las configuraciones espec\'{i}ficas del \textit{appliance} al hacer una \textit{liga simb\'{o}lica} al directorio \texttt{extra}:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # cd /etc/apache2
    # ln -vsf /opt/xNAS/apache2/extra
\end{verbatim}
}

Se instalan y habilitan los m\'{odulos} necesarios para que las funcionalidades del sitio se realizen de manera adecuada, esto incluye la autenticaci\'{o}n y la funcionalidad de \textsc{WebDAV}. Por \'{u}ltimo se reinicia el servicio para aplicar los cambios.

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # aptitude install libapache2-mod-rpaf
    # cd /etc/apache2/sites-available
    # ln -vsf /opt/xNAS/apache2/xnas.local
    # a2dissite default
    # a2enmod headers ssl rewrite ldap authnz_ldap dav dav_fs dav_lock
    # a2enmod proxy proxy_http rpaf
    # a2ensite default
    # /etc/init.d/apache2 restart
\end{verbatim}
}

        \subsubsection {Compatibilidad con clientes \textsc{WebDAV}}

Aunque \textsc{WebDAV} es un est\'{a}ndar definido en el RFC4918 \cite{_rfc_????-2}, existen varios clientes que ofrecen funcionalidades similares aunque son implementados de manera distinta. Por ejemplo, los clientes de \textsc{Mac OS X} y \textsc{GNU/Linux} son los mas completos, mientras que el cliente nativo de Windows (\textit{Microsoft-WebDAV-MiniRedir}) tiene muchos problemas de compatibilidad.

Se utilizaron las directivas \texttt{BrowserMatch} y \texttt{BrowserMatchNoCase} para distinguir a los clientes problem\'{a}ticos que se conectan al servidor y darles un tratamiento especial \cite{_webdav_????} \cite{_fixing_????}. A continuaci\'{o}n se muestran las directivas que se utilizaron para darle un tratamiento especial a los clientes \textsc{WebDAV} nativos de Windows.

{
\scriptsize
\linespread{1}
\begin{verbatim}
Header add MS-Author-Via "DAV" 
BrowserMatch "Microsoft-WebDAV-MiniRedir" redirect-carefully nokeepalive ssl-unclean-shutdown 
\end{verbatim}
}

Para el caso espec\'{i}fico de Windows, es necesario deshabilitar la detecci\'{o}n autom\'{a}tica de proxy en la configuraci\'{o}n de \textit{Internet Explorer}, esto debido a que de manera predeterminada intenta encontrar un servidor proxy \textit{en cada petici\'{o}n que realiza al servidor} \cite{oddball_fix_????} \cite{_slow_????} \cite{_using_????}.

        \subsubsection {Conexi\'{o}n al servidor \textsc{LDAP}}

La conexi\'{o}n al servidor LDAP se configura con la directiva \texttt{AuthLDAPUrl} que especifica los par\'{a}metros de conexi\'{o}n, se compone de dos partes principales:

{
 \begin{table}[H]
 \caption{Par\'{a}metros de conexi\'{o}n \texttt{LDAP}}{}
 \label{tab:ldap-parameters}
 \noindent\makebox[\textwidth]
 {%
  \begin{tabular}[c]{c|c}
  %\hline
  \textbf{Cadena de conexi\'{o}n} & \textbf{Filtro} \\
  \hline \hline
  \textit{Protocolo} & \textsl{Contenedor} \\
  \textit{Host}      & \textsl{Atributos de \'{i}ndice} \\
  \textit{Puerto}    & \textsl{Profundidad y condiciones de la b\'{u}squeda} \\
  %\hline
  \end{tabular}
 } % ending of \makebox
 \end{table}
}

        \subsubsection {B\'{u}squeda en el directorio}

Esta operaci\'{o}n se realiza estableciendo una conexi\'{o}n al servidor para enviar el comando y los par\'{a}metros de b\'{u}squeda. La respuesta puede ser una lista de los identificadores \'{u}nicos de cada elemento encontrado o un resultado vac\'{i}o.

{
\footnotesize
\linespread{1}
\begin{verbatim}
AuthLDAPUrl "ldapi:///ou=users,dc=xnas,dc=local?uid,cn?sub?
             (|(objectClass=posixAccount)(objectClass=simpleSecurityObject))"
\end{verbatim}
}


Para esta URL se realizar\'{a} una b\'{u}squeda en el directorio comenzando en el contenedor principal de usuarios y el objetivo es encontrar objetos de tipo \texttt{posixAccount} o \texttt{simpleSecurityObject} que est\'{e}n indexados por el atributo \textsl{uid} o \textsl{cn}. El alcance de la b\'{u}squeda se establece para todos los objetos que se encuentren bajo esta rama del \'{a}rbol, si se desea que \'{u}nicamente se exploren los objetos en este nivel del directorio, se debe establecer el par\'{a}metro \textsl{one}.

        \subsubsection {Grupos de \textsc{LDAP}}

Para el manejo de permisos de acceso se utilizaron grupos de \textsc{LDAP} que representan a los alumnos que se encuentran inscritos a una materia. Se incluye la directiva \texttt{Require} para establecer en la configuraci\'{o}n que es necesario pertenecer a determinado grupo para tener acceso al recurso solicitado.

{
\footnotesize
\linespread{1}
\begin{verbatim}
Require ldap-group cn=1024-HEBA861228,ou=webdav,ou=groups,dc=xnas,dc=local
\end{verbatim}
}

Al especificar la directiva \texttt{Require ldap-group} se realiza la b\'{u}squeda del usuario y adicionalmente del grupo con el objeto de encontrar todos sus miembros y poder verificar si el usuario en cuesti\'{o}n es uno de ellos.


    \section {Implementaci\'{o}n de las interfaces de usuario}

      \subsection {Acceso mediante el navegador web}

Para acceder mediante el navegador web, simplemente se accede a la URL. De manera predeterminada el servidor pide el usuario y la contrase\~{n}a del usuario para ofrecer el listado de  archivos y directorios disponibles dependiendo de su nivel de acceso.

      \subsection {Acceso mediante cliente nativo de \textsc{WebDAV}}

Para el acceso mediante el cliente nativo se utilizan los siguientes par\'{a}metros. En el ap\'{e}ndice A se puede consultar el manual de conexi\'{o}n.

{
 \begin{table}[H]
 \caption{Par\'{a}metros de conexi\'{o}n \textsc{WebDAV}}{}
 \label{tab:webdav-parameters}
 \noindent\makebox[\textwidth]
 {%
  \begin{tabular}[c]{c|c}
  %\hline
  \textbf{Par\'{a}metro} & \textbf{Valor} \\
  \hline \hline
  \textit{Endpoint} & \texttt{https://xnas.tonejito.org/profesores} \\
  \textit{SSL} & \texttt{true} \\
  \textit{Authentication} & \textsc{basic} \\
  %\hline
  \end{tabular}
 } % ending of \makebox
 \end{table}
}

        \subsubsection {Conector \textsc{WebDAV} desarrollado en \textsl{PowerShell}}

Se desarroll\'{o} una interfaz \textit{frontend} para facilitar a los usuarios de Windows la conexi\'{o}n al servidor \textsc{WebDAV}. Se utiliz\'{o} el lenguaje de programaci\'{o}n \textsl{PowerShell} para lograr que el \textit{script} se pueda ejecutar en versiones recientes de Windows sin necesidad de utilizar alguna otra dependencia.

El programa utiliza de manera interna el comando \texttt{net use} \cite{_net_????} que permite montar una carpeta del servidor \textsc{WebDAV} con una letra de unidad local (Ej. \texttt{Z:}). Es una alternativa a la interfaz est\'{a}ndar que presenta el \textit{Explorador de Windows}. \cite{_create_????}

Una vez que se toman los datos de la \textsc{URL}, el nombre de usuario y la contrase\~{n}a, se llama al comando \texttt{net use} para montar la unidad de red. La interfaz \textit{frontend} tambi\'{e}n toma en cuenta si se desea realizar la operaci\'{o}n en modo persistente, es decir, que la unidad permanezca montada a\'{u}n cuando se reinicie el equipo.

{
\footnotesize
\linespread{1}
\begin{verbatim}
C:\> net use  *  https://xnas.tonejito.org/profesor/<nombre-del-profesor>  \
                 /user:<usuario>        <password>                         \
                 /persistent:<boolean>
\end{verbatim}
}

\newpage
        \subsubsection {Instalaci\'{o}n del conector \textsc{WebDAV} y certificado ra\'{i}z}

Para hacer uso del conector desarrollado en \textsl{PowerShell} o de la interfaz nativa de windows, es necesario instalar el certificado ra\'{i}z de la \textsc{CA} para que el dominio pueda ser validado. 

El \textit{script} \textit{bootstrap} de instalaci\'{o}n \texttt{install.cmd} realiza las siguientes acciones en el equipo:

\begin{itemize}
  \item Descarga y ejecuta el archivo \texttt{install.ps1} con la l\'{o}gica principal del instalador.
  \item Crea el directorio \texttt{C:{\textbackslash}xNAS}.
  \item Descarga el certificado ra\'{i}z \texttt{ca.crt}.
  \item Instala el certificado ra\'{i}z dentro de las \textit{Autoridades Certificadoras de Confianza} utilizando el comando \texttt{certutil}.
  \item Reinicia el servicio \texttt{WebClient} puesto que es utilizado para las conexiones a \textsc{WebDAV}.
  \item Descarga el script \texttt{xNAS-Connector.ps1} y crea un acceso directo en el escritorio.
\end{itemize}

      \subsection {Interfaz de administraci\'{o}n \textit{LDAP Account Manager}}

Se descarga el \textit{tarball} del c\'{o}digo fuente y se descomprime en el directorio \texttt{lam/htdocs}:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # cd /opt/xNAS/app/lam
    # wget -c 'http://iweb.dl.sourceforge.net/project/lam/LAM/4.8/ldap-account-manager-4.8.tar.bz2'
    # tar -xvvjf ldap-account-manager-4.8.tar.bz2 -C /opt/xNAS/app/lam
    # mv ldap-account-manager-4.8 htdocs
\end{verbatim}
}

Se establecen permisos de escritura para el servidor web en los directorios \texttt{sess} y \texttt{temp}:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # chown -cR www-data:www-data /opt/xNAS/app/lam/htdocs/{sess,tmp}
\end{verbatim}
}

Se instalan los archivos de configuraci\'{o}n de la herramienta:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # cd /opt/xNAS/app/lam/htdocs/config
    # ln -vsf ../../lam.conf
    # ln -vsf ../../config.cfg
\end{verbatim}
}

Se instala el certificado, la llave privada y la configuraci\'{o}n del sitio. Una vez realizado esto, se reinicia el servicio:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # cd /etc/ssl/private
    # ln -vsf /opt/xNAS/ssl/admin.xnas.local.key
    # cd /etc/ssl/certs
    # ln -vsf /opt/xNAS/ssl/admin.xnas.local.crt
    # c_rehash

    # cd /etc/apache2/sites-available
    # ln -vsf /opt/xNAS/apache2/admin.xnas.local
    # a2ensite admin.xnas.local
    # /etc/init.d/apache2 reload
\end{verbatim}
}

      \subsection {Interfaz de cambio de contrase\~{n}a}

Se descarga el paquete de instalaci\'{o}n del sitio web oficial y se extrae en el directorio \texttt{ltb/htdocs}:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # cd /opt/xNAS/app/ltb
    # wget -c 'http://tools.ltb-project.org/attachments/download/497/\
      ltb-project-self-service-password-0.8.tar.gz'
    # tar -xvvzf ltb-project-self-service-password-0.8.tar.gz -C /opt/xNAS/app/ltb
    # mv ltb-project-self-service-password-0.8 htdocs
\end{verbatim}
}

Se instala el certificado, la llave privada y la configuraci\'{o}n del \texttt{VirtualHost}, hecho esto se reinicia el servicio para reflejar los cambios.

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # cd /etc/ssl/private
    # ln -vsf /opt/xNAS/ssl/reset.xnas.local.key
    # cd /etc/ssl/certs
    # ln -vsf /opt/xNAS/ssl/reset.xnas.local.crt
    # c_rehash

    # cd /etc/apache2/sites-available
    # ln -vsf /opt/xNAS/apache2/reset.xnas.local
    # a2ensite reset.xnas.local
    # /etc/init.d/apache2 reload
\end{verbatim}
}

    \section {Hardening}

      \subsection {Actualizaciones desatendidas}

Una parte importante de la configuraci\'{o}n de seguridad de un sistema radica en la instalaci\'{o}n peri\'{o}dica de actualizaciones. Al ejecutar el siguiente comando y responder \textbf{YES} en el cuadro de di\'{a}logo, se configura el sistema para descargar e instalar \emph{autom\'{a}ticamente} las actualizaciones de seguridad que sean liberadas por el fabricante del sistema operativo.

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # dpkg-reconfigure unattended-upgrades

+------------------------+ Configuring unattended-upgrades +------------------------+
| Applying updates on a frequent basis is an important part of keeping systems      |
| secure. By default, updates need to be applied manually using package management  |
| tools. Alternatively, you can choose to have this system automatically download   |
| and install security updates.                                                     |
|                                                                                   |
| Automatically download and install stable updates?                                |
|                       <Yes>                          <No>                         |
+-----------------------------------------------------------------------------------+
\end{verbatim}
}

      \subsection {Reducci\'{o}n de componentes instalados}

Como parte de la configuraci\'{o}n de seguridad, es recomendable minimizar los paquetes que se instalan en el sistema operativo para disminuir la ventana de posibilidades de tener una intrusi\'{o}n. Con la siguiente configuraci\'{o}n del gestor de paquetes se evita la instalaci\'{o}n de \textit{software} adicional cuando se agrega un paquete. Esto ayuda a reducir la complejidad del sistema y reduce el espacio en disco utilizado. \cite{_configuration_????}

{
\scriptsize
\linespread{1}
\begin{verbatim}
# cat > /etc/apt/apt.conf.d/10Hardening << EOF
Apt::Install-Recommends "false";
Apt::Install-Suggests   "false";
EOF
\end{verbatim}
}

      \subsection {Evitar el apagado o reinicio accidental del equipo}

Al administrar un equipo de manera remota se corre el riesgo de ejecutar por error el comando de apagado o reinicio. Al suceder esto se pierde la sesi\'{o}n de todos los usuarios, los servicios se interrumpen y si se dio la \'{o}rden de apagado, ser\'{a} necesario acudir a la ubicaci\'{o}n f\'{i}sica del equipo y encenderlo manualmente.

Para mitigar este riesgo se instal\'{o} el programa \texttt{molly-guard}. Al detectar el uso de comandos para apagar o reiniciar el sistema desde una sesi\'{o}n remota, preguntar\'{a} el nombre del equipo para hacer una verificaci\'{o}n adicional y evitar que un equipo sea apagado o reiniciado accidentalmente de manera remota. El programa se instal\'{o} utilizando el siguiente comando:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # aptitude install molly-guard
\end{verbatim}
}

      \subsection {Reenv\'{i}o del correo electr\'{o}nico de \texttt{root}}

Se instal\'{o} en el equipo el \textsl{MTA} \texttt{Postfix} configurado como \textit{Internet Site}. Para habilitar la redirecci\'{o}n de los mensajes de correo electr\'{o}nico dirigidos al administrador del sistema se realiz\'{o} lo siguiente:

\begin{itemize}
  \item Especificar la direccion de destino en el archivo \texttt{/etc/aliases}:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    root:	xnas@tonejito.org
\end{verbatim}
}

  \item Regenerar la base de datos de \textit{aliases}:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # newaliases
\end{verbatim}
}

  \item Recargar la configuraicon del servicio de correo:

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # /etc/init.d/postfix reload
\end{verbatim}
}

\end{itemize}

      \subsection {Restricci\'{o}n de acceso para las tareas programadas}

Para limitar la capacidad de los usuarios para programar la ejecuci\'{o}n de comandos en el sistema operativo se adopt\'{o} una politica restrictiva que consiste en tener una \textit{lista blanca} donde \'{u}nicamente los usuarios del sistema \footnote{Con \textbf{uid} menor a 1000} pueden hacer uso de trabajos de \textsl{cron} y \textsl{at}. \cite{_debian_????-1} \cite{_crontab_????} \cite{_at_????}

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # cd /etc
    # getent passwd | sort -g -t ":" -k 3,3 | awk -F: '$3<1000 {print $1}' | tee cron.allow
    # ln -v cron.allow at.allow
\end{verbatim}
}

      \subsection {Configuraci\'{o}n de seguridad de \textsl{OpenSSH}}

Para la configuraci\'{o}n del servicio de \textsc{SSH} se aplicaron las siguientes opciones en el archivo de configuraci\'{o}n \texttt{/etc/ssh/sshd\_config}

\begin{itemize}
  \item Quita el nombre del sistema operativo del banner inicial de \textsc{SSH}.
    \code{DebianBanner no}
  \item Deshabilitar el acceso administrativo utilizando contrase\~{n}a, \'{u}nicamente se permite el inicio de sesi\'{o}n como \texttt{root} al utilizar autenticaci\'{o}n de llave p\'{u}blica.
    \code{PermitRootLogin without-password}
  \item Deshabilitar el acceso a cuentas que tengan una contrase\~{n}a vac\'{i}a.
    \code{PermitEmptyPasswords no}
  \item Permitir el acceso al grupo de usuarios de la \textit{Unidad de C\'{o}mputo} de la \textsc{DICyG}.
    \code{AllowGroups adm staff support}
  \item  Mostrar una pantalla antes de iniciar la sesi\'{o}n en la que se listen las pol\'{i}ticas de uso del sistema.
    \code{Banner /etc/issue.net}
  \item Evitar la desconexi\'{o}n manteniendo actividad en la sesi\'{o}n.
    \code{TCPKeepAlive yes}
    \code{ClientAliveInterval 30}
  \item Evitar la redirecci\'{o}n de puertos y sesiones gr\'{a}ficas.
    \code{AllowTCPForwarding no}
    \code{GatewayPorts no}
    \code{X11Forwarding no}
  \item Desconectar al usuario si no inicia sesi\'{o}n en 60 segundos.
    \code{LoginGraceTime 60}
\end{itemize}

      \subsection {Reglas de Firewall}
      \label{subsec:fw-rules}

Para filtrar el tr\'{a}fico de red se establecieron las siguientes pol\'{i}ticas de \textit{firewall} de host en el equipo:

\begin{itemize}
  \item Se permite todo el tr\'{a}fico proveniente de la interfaz \textit{loopback}.
  \item Las conexiones a trav\'{e}s de \textsc{SSH} se permiten \'{u}nicamente desde los siguientes segmentos confiables de red:
  \begin{enumerate}
    \item Segmentos de \textsc{RedUNAM}: \texttt{132.247.0.0/16} , \texttt{132.248.0.0/16}
    \item Red interna de la \textsc{DICyG}.
  \end{enumerate}
  \item Se permiten las conexiones por \textsc{HTTPS} desde cualquier host, ya sea de la red interna, segmentos de \textsc{RedUNAM} o Internet.
  \item Las conexiones al demonio de \textsc{LDAP} se permiten \'{u}nicamente desde \textit{localhost}.
\end{itemize}

Para implementar las reglas de \textit{firewall} se utiliz\'{o} \texttt{iptables} para el filtrado de paquetes en \textsc{GNU/Linux} y el paquete \texttt{iptables-persistent} que sirve para aplicar las reglas guardadas en cada inicio del sistema operativo. El programa se instala con \texttt{aptitude} y al configurarlo pregunta si se guardar\'{a}n las reglas de \textsc{IPv4} e \textsc{IPv6}.

{
\scriptsize
\linespread{1}
\begin{verbatim}
    # aptitude install iptables-persistent

+--------------------| Configuring iptables-persistent |--------------------+
|                                                                           |
| Current iptables rules can be saved to the configuration file             |
| /etc/iptables/rules.v4. These rules will then be loaded automatically     |
| during system startup.                                                    |
|                                                                           |
| Rules are only saved automatically during package installation. See the   |
| manual page of iptables-save(8) for instructions on keeping the rules     |
| file up-to-date.                                                          |
|                                                                           |
| Save current IPv4 rules?                                                  |
|                                                                           |
|                    <Yes>                       <No>                       |
|                                                                           |
+---------------------------------------------------------------------------+
\end{verbatim}
}

        \subsubsection {Protecci\'{o}n contra ataques de fuerza bruta con \textit{fail2ban}}

Este \textit{software} realiza un seguimiento de las conexiones que se realizan al equipo e identifica los ataques de fuerza bruta contra el servicio de \textsc{SSH}. Al detectar un ataque, realiza un bloqueo de la direcci\'{o}n \textsc{IP} de origen por un tiempo determinado.

Es necesario instalar el \textit{software} y hacer una copia del archivo \texttt{jail.conf} con el nombre \texttt{jail.local} donde se realizar\'{a}n ajustes a la configuraci\'{o}n del servicio.

{
\scriptsize
\linespread{1}
\begin{verbatim}
# aptitude install fail2ban
# cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local
\end{verbatim}
}

Una vez copiado el archivo de configuraci\'{o}n, se agregan los bloques \textsc{CIDR} definidos en el \textsc{RFC1918} y los segmentos de \textsc{RedUNAM} que se definieron en la secci\'{o}n \ref{subsec:fw-rules} en la p\'{a}gina \pageref{subsec:fw-rules}. Adicionalmente se incrementa el tiempo de bloqueo de la direcci\'{o}n IP del atacante de 600 segundos a 3600 (una hora).

{
\scriptsize
\linespread{1}
\begin{verbatim}
[DEFAULT]
# "ignoreip" can be an IP address, a CIDR mask or a DNS host
ignoreip = 127.0.0.0/8 10.0.0.0/8 172.16.0.0/12 192.168.0.0/16 132.247.0.0/16 132.248.0.0/16
# seconds
bantime  = 3600
maxretry = 3
\end{verbatim}
}

Al finalizar el ajuste de los par\'{a}metros de configuraci\'{o}n, se reinicia el servicio.

{
\scriptsize
\linespread{1}
\begin{verbatim}
# service fail2ban restart
\end{verbatim}
}

      \subsection {Configuraci\'{o}n de seguridad de Apache HTTPD}

Se establecieron los valores recomendados en las siguientes directivas con el objetivo de evitar la divulgaci\'{o}n de informaci\'{o}n acerca del \textit{software} del servidor web y el sistema operativo. Estas directivas se encuentran presentes en el archivo \texttt{/etc/apache2/conf.d/security}.

{
 \begin{table}[H]
 \caption{Directivas de seguridad de Apache \textsc{HTTPD}}{}
 \label{tab:apache-hardening}
 \noindent\makebox[\textwidth]
 {%
  \begin{tabular}[c]{r|c}
  %\hlinoo
  \multicolumn{1}{c}{\textbf{Directiva}} & \multicolumn{1}{c}{\textbf{Valor}} \\
  \hline \hline
  \texttt{ServerSignature} & Off         \\
  \texttt{ServerTokens}    & ProductOnly \\
  \texttt{TraceEnable}     & Off         \\
  %\hline
  \end{tabular}
 } % ending of \makebox
 \end{table}
}

        \subsubsection{Configuraci\'{o}n para \textsc{PHP}}

Se configur\'{o} \textsc{PHP} para que no muestre la versi\'{o}n en las cabeceras del protocolo \textsc{HTTP}, evitar la impresi\'{o}n de errores y para que guarde los errores encontrados en una bit\'{a}cora. Para lograr esto, se establecieron los siguientes valores en el archivo \texttt{php.ini}.

{
 \begin{table}[H]
 \caption{Directivas de seguridad de \textsc{PHP}}{}
% \label{tab:php-hardening}
 \noindent\makebox[\textwidth]
 {%
  \begin{tabular}[c]{r|c}
  %\hline
  \multicolumn{1}{c}{\textbf{Directiva}} & \multicolumn{1}{c}{\textbf{Valor}} \\
  \hline \hline
  \texttt{expose\_php}              & Off \\
  \texttt{display\_errors}          & Off \\
  \texttt{display\_startup\_errors} & Off \\
  \texttt{log\_errors}              & On  \\
  \texttt{error\_log}               & /var/log/apache2/error.log  \\
  %\hline
  \end{tabular}
 } % ending of \makebox
 \end{table}
}

        \subsubsection{Deshabilitar el soporte de archivos \texttt{.htaccess}}

Se agreg\'{o} esta directiva de configuraci\'{o}n dentro de un bloque \texttt{<Directory>} para que el servidor ignore los archivos de configuraci\'{o}n \texttt{.htaccess} debido a que podr\'{i}an ser modificados por los usuarios.

{
\scriptsize
\linespread{1}
\begin{verbatim}
AllowOverride none
\end{verbatim}
}

        \subsubsection{Restricci\'{o}n de permisos de escritura}

Los m\'{e}todos \textsc{HTTP} se pueden clasificar de acuerdo al tipo de acceso que tienen, ya sea para obtener o enviar datos al servidor. En la siguiente tabla se muestra la clasificaci\'{o}n de acuerdo a este criterio:

{
 \linespread{1}
 \begin{table}[H]
 \caption{Clasificaci\'{o}n de m\'{e}todos \textsc{HTTP}}{}
 \label{tab:http-methods}
 \noindent\makebox[\textwidth]
 {%
  \begin{tabular}[c]{c|c c c}
  %\hline
  \textbf{Tipo} & & \textbf{M\'{e}todos} & \\
  \hline \hline
  \multirow{2}{*}{\textsl{S\'{o}lo lectura}} & \texttt{OPTIONS} & \texttt{PROPFIND} & \\ 
                                             & \texttt{HEAD}    & \texttt{GET}      & \\
  \hline
  \multirow{4}{*}{\textsl{Lectura y Escritura}} & \texttt{POST}      & \texttt{PUT}    & \texttt{MKCOL}  \\
                                                & \texttt{COPY}      & \texttt{MOVE}   & \texttt{DELETE} \\
                                                & \texttt{LOCK}      & \texttt{UNLOCK} & \texttt{PATCH}  \\
                                                & \texttt{PROPPATCH} &                 & \\
  %\hline
  \end{tabular}
 } % ending of \makebox
 \end{table}
}

Para establecer una restricci\'{o}n a los m\'{e}todos \textsc{HTTP} que pueden escribir datos en el servidor se utiliz\'{o} la directiva \texttt{LimitExcept} para definir los m\'{e}todos que se permiten en el servidor en determinado directorio \cite{_core_????}. En el siguiente ejemplo se muestra la configuraci\'{o}n adoptada para permitir el acceso de solo lectura.


{
\scriptsize
\linespread{1}
\begin{verbatim}
<LimitExcept GET OPTIONS PROPFIND>
  Satisfy ALL
  Require ldap-group _
  Order Allow,Deny
  Deny From ALL
</LimitExcept>
\end{verbatim}
}

